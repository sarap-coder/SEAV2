<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <arg name="joint_name_1" default=""/>
    <arg name="joint_name_2" default=""/>
    <arg name="joint_name_suffix" default=""/>

    <arg name="transmission_name" default=""/>
    <arg name="controller_pkg_name" default=""/>
    <arg name="ns" default=""/>
    <arg name="open_loop" default="false"/>
    <arg name="safety_override" default=""/>

    <arg name="transmission_ns" value="$(eval arg('ns') + '/joints/' + arg('transmission_name') + '/')"/>

    <group>
        <arg name="joint_name" value="$(arg joint_name_1)"/>
        <arg name="joint_ns" value="$(arg transmission_ns)/$(arg joint_name)"/>

        <include file="$(find pal_local_joint_control)/launch/load_safety_parameters.launch">
            <arg name="joint_cfg_name" value="$(arg joint_name)$(arg joint_name_suffix)"/>
            <arg name="controller_pkg_name" value="$(arg controller_pkg_name)"/>
            <arg name="ns" value="$(arg transmission_ns)/"/>
            <arg name="joint_name" value="$(arg joint_name)"/>
            <arg name="safety_override" value="$(arg safety_override)"/>
        </include>

        <rosparam command="load" ns="$(eval arg('joint_ns') + '/actuator_params')" file="$(eval find(arg('controller_pkg_name')) + '/config/local_joint_control/actuator_parameters/' + arg('joint_name') + '.yaml')" />
    </group>

    <group>
        <arg name="joint_name" value="$(arg joint_name_2)"/>
        <arg name="joint_ns" value="$(arg transmission_ns)/$(arg joint_name)"/>

        <include file="$(find pal_local_joint_control)/launch/load_safety_parameters.launch">
            <arg name="joint_cfg_name" value="$(arg joint_name)$(arg joint_name_suffix)"/>
            <arg name="controller_pkg_name" value="$(arg controller_pkg_name)"/>
            <arg name="ns" value="$(arg transmission_ns)/"/>
            <arg name="joint_name" value="$(arg joint_name)"/>
            <arg name="safety_override" value="$(arg safety_override)"/>
        </include>
        
        <rosparam command="load" ns="$(eval arg('joint_ns') + '/actuator_params')" file="$(eval find(arg('controller_pkg_name')) + '/config/local_joint_control/actuator_parameters/' + arg('joint_name') + '.yaml')" />
    </group>

    <param name="$(eval arg('ns') + '/joints/' + arg('transmission_name') + '/type')" value="pal_local_joint_control::DifferentialEffortControl"/>

</launch>
